<!DOCTYPE html>
<html lang="de">
<head>
    <link rel="icon" type="image/x-icon" href="icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
          rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape the lifetime sentence</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #87CEEB;
            font-family: "Chakra Petch", sans-serif;
            font-weight: 400;
            font-style: normal;
        }

        #game {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #8B4513; /* Bodenfarbe */
            background-image: url("flor.jpg");
            background-size: cover;
        }

        #player {
            position: absolute;
            width: calc(2vw + 2vh);
            height: calc(2vw + 2vh);
            background-color: red;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-image: url('schoel.jfif'); /* Hintergrundbild hinzufügen */
            background-size: cover; /* Bild auf die gesamte Größe des Elements skalieren */
        }

        #timer {
            position: absolute;
            top: 1vh;
            right: 1vw;
            width: 10vw;
            height: 8vh;
            padding: calc(0.3vh + 0.3vw);
            background-color: #333;
            color: #fff;
            font-size: calc(2vw + 3vh);
            border-radius: calc(1vh + 1vw);
            text-align: center;
            z-index: 1000; /* Beispielwert, je höher der Wert, desto weiter vorne liegt das Element */
        }

        .obstacle {
            position: absolute;
            width: calc(3vw + 3vh);
            height: calc(3vw + 3vh);
            background-color: green;
            animation-duration: 2s;
            animation-iteration-count: infinite;
            animation-timing-function: linear;
            background-image: url('polis.png'); /* Hintergrundbild hinzufügen */
            background-size: cover; /* Bild auf die gesamte Größe des Elements skalieren */
        }

        @keyframes moveHorizontalFromRight {
            0% {
                left: 100vw;
            }
            100% {
                left: calc(-4vw - 3vh);
            }
        }

        @keyframes moveVerticalFromTop {
            0% {
                top: calc(-4vw + -3vh);
            }
            100% {
                top: 100vh;
            }
        }

        @keyframes moveHorizontalFromLeft {
            0% {
                left: calc(-4vw + -3vh);
            }
            100% {
                left: 100vw;
            }
        }

        @keyframes moveVerticalFromBottom {
            0% {
                top: 100vh;
            }
            100% {
                top: calc(-4vw + -3vh);
            }
        }
    </style>
</head>
<body>
<div id="game">
    <div id="player"></div>
    <div id="timer"></div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const game = document.getElementById('game');
        const player = document.getElementById('player');
        let previousPositionTop = 50;
        let previousPositionLeft = 50;
        let moveSpeed = 0.2; // Geschwindigkeit in vw und vh
        let max = 3000;
        let min = max - 500;
        let firstMove = true;
        let seconds = 0;
        let minutes = 0;
        let playTime = 0;
        let firstTimeHandler = true;
        let randNumber;
        let aidsTimeout = 50;
        let spasst = false;

        let keys = {
            w: false,
            a: false,
            s: false,
            d: false
        };

        let timerInterval;
        let obstacleInterval;

        function addLeadingZero(num) {
            return num < 10 ? '0' + num : num;
        }

        function startTimer() {
            timerInterval = setInterval(updateTimer, 1000);
        }

        function obstacleHandler() {
            if (firstTimeHandler) {
                max = 1.5 - (playTime / 30);
                if (max <= 0.2) {
                    max = 0.2;
                }
                if(playTime >= 90){
                    max = 0.14;
                }
                max *= 100;
                min = max - 5;
                firstTimeHandler = false;
                randNumber = Math.round(Math.random() * (max - min) + min);
            }
            randNumber--;
            if (randNumber === 0) {
                firstTimeHandler = true;
                createObstacle();
            }
        }

        function updateTimer() {
            seconds++;
            if (seconds === 60) {
                seconds = 0;
                minutes++;
                if (minutes <= 9) {
                    minutes = addLeadingZero(minutes);
                }
            }
            moveSpeed = 0.2 + (playTime / 90);
            if (moveSpeed >= 1) {
                moveSpeed = 1;
            }
            playTime = (minutes * 60) + seconds;
            seconds = addLeadingZero(seconds);
            document.getElementById('timer').textContent = '';
            document.getElementById('timer').append(minutes + ":" + seconds);
            if (playTime === 200) {
                setInterval(aids, 10);
            }
        }

        function movePlayer() {
            if (firstMove) {
                startTimer();
                firstMove = false;
            }
            let playerTop = parseFloat(player.style.top) || previousPositionTop;
            let playerLeft = parseFloat(player.style.left) || previousPositionLeft;
            let playerHeight = parseFloat(player.style.height) || 0;
            let playerWidth = parseFloat(player.style.width) || 0;

            previousPositionTop = parseFloat(player.style.top);
            previousPositionLeft = parseFloat(player.style.left);

            if (keys.w) {
                playerTop = Math.max(0, playerTop - (moveSpeed * 1.3));
            }
            if (keys.a) {
                playerLeft = Math.max(0, playerLeft - moveSpeed);
            }
            if (keys.s) {
                playerTop = Math.min(100 - (playerHeight / window.innerHeight * 100), playerTop + (moveSpeed * 1.3));
            }
            if (keys.d) {
                playerLeft = Math.min(100 - (playerWidth / window.innerWidth * 100), playerLeft + moveSpeed);
            }

            player.style.top = `${playerTop}vh`;
            player.style.left = `${playerLeft}vw`;

            requestAnimationFrame(movePlayer);
        }

        function createObstacle() {
            const obstacle = document.createElement('div');
            obstacle.classList.add('obstacle');
            // Zufällige Auswahl einer Bewegungsrichtung für das Hindernis
            const direction = Math.floor(Math.random() * 4); // 0 bis 3
            switch (direction) {
                case 0: // Von oben
                    obstacle.style.top = 'calc(-4vw + -3vh)';
                    obstacle.style.left = `${Math.random() * 100}vw`;
                    obstacle.style.animationName = 'moveVerticalFromTop';
                    break;
                case 1: // Von rechts
                    obstacle.style.top = `${Math.random() * 100}vh`;
                    obstacle.style.left = '100vw';
                    obstacle.style.animationName = 'moveHorizontalFromRight';
                    break;
                case 2: // Von unten
                    obstacle.style.top = '100vh';
                    obstacle.style.left = `${Math.random() * 100}vw`;
                    obstacle.style.animationName = 'moveVerticalFromBottom';
                    break;
                case 3: // Von links
                    obstacle.style.top = `${Math.random() * 100}vh`;
                    obstacle.style.left = 'calc(-4vw + -3vh)';
                    obstacle.style.animationName = 'moveHorizontalFromLeft';
                    break;
            }
            let duration = (2.5 - (playTime / 60));
            duration = duration + 1.2;
            if (duration <= 1.2) {
                duration = 1.2;
            }
            if ((direction === 1) || (direction === 3)) {
                duration += 0.2;
            }
            obstacle.style.animationDuration = duration + 's';

            game.appendChild(obstacle);
            setTimeout(() => {
                obstacle.remove();
            }, duration * 1000);
        }

        document.addEventListener('keydown', event => {
            if (event.code === 'KeyW') {
                keys.w = true;
            }
            if (event.code === 'KeyA') {
                keys.a = true;
            }
            if (event.code === 'KeyS') {
                keys.s = true;
            }
            if (event.code === 'KeyD') {
                keys.d = true;
            }
        });

        document.addEventListener('keyup', event => {
            if (event.code === 'KeyW') {
                keys.w = false;
            }
            if (event.code === 'KeyA') {
                keys.a = false;
            }
            if (event.code === 'KeyS') {
                keys.s = false;
            }
            if (event.code === 'KeyD') {
                keys.d = false;
            }
        });

        function aids() {
            document.getElementById("game").style.filter = 'invert(1)';
            setTimeout(function () {
                document.getElementById("game").style.filter = 'invert(0)';
            }, aidsTimeout);
            setTimeout(function () {
                document.getElementById("game").style.filter = 'invert(1)';
            }, 2 * aidsTimeout);
            setTimeout(function () {
                document.getElementById("game").style.filter = 'invert(0)';
            }, 3 * aidsTimeout);
            setTimeout(function () {
                document.getElementById("game").style.filter = 'invert(1)';
            }, 4 * aidsTimeout);
            setTimeout(function () {
                document.getElementById("game").style.filter = 'invert(0)';
            }, 5 * aidsTimeout);
        }

        function gameLoop() {
            const playerRect = player.getBoundingClientRect();
            document.querySelectorAll('.obstacle').forEach(obstacle => {
                const obstacleRect = obstacle.getBoundingClientRect();
                if (
                    (playerRect.left < obstacleRect.left + obstacleRect.width &&
                    playerRect.left + playerRect.width > obstacleRect.left &&
                    playerRect.top < obstacleRect.top + obstacleRect.height &&
                    playerRect.top + playerRect.height > obstacleRect.top) || spasst
                ) {

                    downloadTextFile();

                    alert(generateInsult());
                    location.reload();

                    // Automatisch den Download auslösen, wenn die Seite geladen ist


                }
            });
            requestAnimationFrame(gameLoop);
        }

        function pauseGame() {
            clearInterval(timerInterval);
        }

        function resumeGame() {
            timerInterval = setInterval(updateTimer, 1000);
        }

        document.addEventListener('visibilitychange', function () {
            if (document.hidden) {
                pauseGame();
                spasst = true;
            } else {
                resumeGame();
            }
        });

        function downloadTextFile() {
            // Inhalt der Datei
            var content = minutes + ":" + seconds + "\n" + generateInsult();

            // Eine neue Blob (Binary Large Object) erstellen
            var blob = new Blob([content], { type: 'text/plain' });

            // URL für den Blob erstellen
            var url = URL.createObjectURL(blob);

            // Ein unsichtbares <a> Element erstellen
            var a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = generateInsult(); // Dateinamen hier anpassen

            // Das <a> Element dem Dokument hinzufügen
            document.body.appendChild(a);

            // Klick auf das <a> Element auslösen, um den Download zu starten
            a.click();

            // Das <a> Element wieder entfernen
            document.body.removeChild(a);

            // Den URL-Object für den Blob wieder freigeben
            URL.revokeObjectURL(url);
        }

        function generateInsult() {
            // Liste von 100 bekannten englischen Beleidigungen
            var insults = [
                "You're a clown.",
                "You're such a jerk.",
                "You're a moron.",
                "You're an idiot.",
                "You're a loser.",
                "You're so dumb.",
                "You're a tool.",
                "You're a waste of space.",
                "You're a fool.",
                "You're a knob.",
                "You're a twit.",
                "You're an imbecile.",
                "You're a cretin.",
                "You're a numpty.",
                "You're a pillock.",
                "You're a muppet.",
                "You're a prat.",
                "You're a git.",
                "You're a wanker.",
                "You're a dickhead.",
                "You're an arsehole.",
                "You're a douchebag.",
                "You're a dipshit.",
                "You're a dumbass.",
                "You're a jackass.",
                "You're a bastard.",
                "You're a scumbag.",
                "You're a twat.",
                "You're a knobhead.",
                "You're a bellend.",
                "You're a tosser.",
                "You're a knob cheese.",
                "You're a numbnuts.",
                "You're a douche nozzle.",
                "You're a turd.",
                "You're a prick.",
                "You're a cockwomble.",
                "You're a piece of shit.",
                "You're a motherfucker.",
                "You're a fucking idiot.",
                "You're a dumb motherfucker.",
                "You're a fucking asshole.",
                "You're a fucking moron.",
                "You're an absolute idiot.",
                "You're a complete idiot.",
                "You're a bloody idiot.",
                "You're a fucking imbecile.",
                "You're an idiotic twat.",
                "You're a fucking pillock.",
                "You're a fucking muppet.",
                "You're a fucking tool.",
                "You're a complete knob.",
                "You're a total twat.",
                "You're an absolute moron.",
                "You're a bloody fool.",
                "You're an idiotic cunt.",
                "You're a fucking fuckwit.",
                "You're a fucking waste of space.",
                "You're a fucking loser.",
                "You're a complete idiot.",
                "You're a fucking cretin.",
                "You're a complete numpty.",
                "You're a fucking dumbass.",
                "You're a fucking wanker.",
                "You're a fucking dickhead.",
                "You're a fucking dipshit.",
                "You're a fucking twit.",
                "You're a complete prick.",
                "You're a complete bastard.",
                "You're a fucking scumbag.",
                "You're a fucking knobhead.",
                "You're a complete bellend.",
                "You're a fucking tosser.",
                "You're a fucking numbnuts.",
                "You're a fucking douche nozzle.",
                "You're a fucking turd.",
                "You're a fucking prick.",
                "You're a fucking cockwomble.",
                "You're a fucking piece of shit.",
                "You're a fucking motherfucker.",
                "You're a fucking asshole.",
                "You're a fucking dumb motherfucker.",
                "You're a fucking fucking idiot.",
                "You're a fucking fucking asshole.",
                "You're a fucking fucking moron.",
                "You're a fucking fucking cunt.",
                "You're a fucking fucking wanker.",
                "You're a fucking fucking dipshit.",
                "You're a fucking fucking twat.",
                "You're a fucking fucking dickhead.",
                "You're a fucking fucking tosser.",
                "You're a fucking fucking turd.",
                "You're a fucking fucking prick.",
                "You're a fucking fucking scumbag.",
                "You're a fucking fucking piece of shit.",
                "You're a fucking fucking motherfucker.",
                "You're a fucking fucking asshole.",
                "You're a fucking fucking moron.",
                "You're a fucking fucking asshole.",
                "You're a fucking fucking cunt.",
                "You're a fucking fucking dipshit.",
                "You're a fucking fucking twat.",
                "You're a fucking fucking dickhead.",
                "You're a fucking fucking tosser.",
                "You're a fucking fucking turd.",
                "You're a fucking fucking prick.",
                "You're a fucking fucking scumbag.",
                "You're a fucking fucking piece of shit.",
                "You're a fucking fucking motherfucker.",
                "You're a fucking fucking asshole.",
                "You're a fucking fucking moron.",
                "I hope you die.",
                "You don't deserve to live.",
                "kys",
                "wadasigma",
                "skibiditoilet",
                "Jump off a bridge"
            ];

            // Zufällige Beleidigung auswählen
            var randomInsult = insults[Math.floor(Math.random() * insults.length)];

            return randomInsult;
        }

        obstacleInterval = setInterval(obstacleHandler, 10);
        movePlayer();
        gameLoop();
    });
</script>
</body>
</html>